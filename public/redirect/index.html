<!DOCTYPE html>
<html lang="en">

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="shortcut icon" type="image/png" href="../favicon.png" />
	<title>Order Confirmation | Maesh Express Example</title>
	<!-- Include the script tag in the headâ€‹ tag of your HTML file. -->
<script src="https://js.maesh.io/prod/v1.js"></script>
	<style>
		.bg {
			background-color: #6c7bee;
			width: 480px;
			overflow: hidden;
			margin: 0 auto;
			box-sizing: border-box;
			padding: 40px;
			font-family: 'Roboto';
			margin-top: 40px;
		}

		.card {
			background-color: #fff;
			width: 100%;
			float: left;
			margin-top: 40px;
			border-radius: 5px;
			box-sizing: border-box;
			padding: 80px 30px 25px 30px;
			text-align: center;
			position: relative;
			box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
		}

		.card__success {
			position: absolute;
			top: -50px;
			left: 145px;
			width: 100px;
			height: 100px;
			border-radius: 100%;
			background-color: #60c878;
			border: 5px solid #fff;
		}

		.card__success i {
			color: #fff;
			line-height: 100px;
			font-size: 45px;
		}

		.card__error {
			position: absolute;
			top: -50px;
			left: 145px;
			width: 100px;
			height: 100px;
			border-radius: 100%;
			background-color: red;
			border: 5px solid #fff;
		}

		.card__error i {
			color: #fff;
			line-height: 100px;
			font-size: 45px;
		}

		.card__msg {
			text-transform: uppercase;
			color: #55585b;
			font-size: 18px;
			font-weight: 500;
			margin-bottom: 5px;
		}

		.card__submsg {
			color: #959a9e;
			font-size: 16px;
			font-weight: 400;
			margin-top: 0px;
		}

		.card__body {
			background-color: #f8f6f6;
			border-radius: 4px;
			width: 100%;
			margin-top: 30px;
			float: left;
			box-sizing: border-box;
			padding: 30px;
		}

		.card__avatar {
			width: 50px;
			height: 50px;
			border-radius: 100%;
			display: inline-block;
			margin-right: 10px;
			position: relative;
			top: 7px;
		}

		.card__recipient-info {
			display: inline-block;
		}

		.card__recipient {
			color: #232528;
			text-align: left;
			margin-bottom: 5px;
			font-weight: 600;
		}

		.card__email {
			color: #838890;
			text-align: left;
			margin-top: 0px;
		}

		.card__price {
			color: #232528;
			font-size: 70px;
			margin-top: 25px;
			margin-bottom: 30px;
		}

		.card__price span {
			font-size: 60%;
		}

		.card__method {
			color: #d3cece;
			text-transform: uppercase;
			text-align: left;
			font-size: 11px;
			margin-bottom: 5px;
		}

		.card__payment {
			background-color: #fff;
			border-radius: 4px;
			width: 100%;
			height: 100px;
			box-sizing: border-box;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.card__credit-card {
			width: 50px;
			display: inline-block;
			margin-right: 15px;
		}

		.card__card-details {
			display: inline-block;
			text-align: left;
		}

		.card__card-type {
			text-transform: uppercase;
			color: #232528;
			font-weight: 600;
			font-size: 12px;
			margin-bottom: 3px;
		}

		.card__card-number {
			color: #838890;
			font-size: 12px;
			margin-top: 0px;
		}

		.card__tags {
			clear: both;
			padding-top: 15px;
		}

		.card__tag {
			text-transform: uppercase;
			background-color: #f8f6f6;
			box-sizing: border-box;
			padding: 3px 5px;
			border-radius: 3px;
			font-size: 10px;
			color: #d3cece;
		}
	</style>
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700,900" rel="stylesheet" />
	<link href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" />
</head>

<body>
	<div class="bg">
		Your payment status is <h3 id="status_maesh"></h3>

		<div class="card" id="success">

			<span class="card__success"><i class="ion-checkmark"></i></span>

			<h1 class="card__msg">Order Confirmed!</h1>
			<h2 class="card__submsg">Thank you for your transfer</h2>
			<h2 class="card__submsg">Status of Transaction: <span id="succStatus"></span> </h2>

			<div class="card__tags">
				<span class="card__tag">completed</span>
				<span class="card__tag">#123456789</span>
			</div>

		</div>

		<div class="card" id="error">

			<span class="card__error"><i class="ion-close"></i></span>

			<h1 class="card__msg">Something went wrong!</h1>
			<h2 class="card__submsg">Nothing to see here</h2>
			<h2 class="card__submsg">Status of Transaction: <span id="errStatus"></span></h2>

		</div>

	</div>
	<script src="../js/constants.js"></script>
	<script>
		function getOrderData(){
	const queryString = window.location.search;
	const urlParams = new URLSearchParams(queryString);
	const reference = urlParams.get('reference');
	const xhttp = new XMLHttpRequest();
	if(!reference){
		document.getElementById('success').style.display = 'none';
					document.getElementById('error').style.display = 'block';
					document.getElementById('errStatus').innerHTML = 'Error';
		return;
	}
	else{
	const url = request_url+'/orders/' + reference;

	xhttp.open("GET", url, false);
	xhttp.send();

	console.log(xhttp.responseText);
	const order = JSON.parse(xhttp.responseText);

	status = order["status"];
				if (status === 'pending' || status === 'Unpaid') {
					document.getElementById('success').style.display = 'none';
					document.getElementById('error').style.display = 'block';
					document.getElementById('errStatus').innerHTML = status;
				} else {
					document.getElementById('success').style.display = 'block';
					document.getElementById('error').style.display = 'none';
					document.getElementById('succStatus').innerHTML = status;
				}
	return;
	}
}

getOrderData();


// Include below code in a script tag
const maesh = Maesh();
const maeshStatus = maesh.callback();
// Resolve promise to get status of payment.
maeshStatus.then(
    status => {
    	document.getElementById("status_maesh").innerHTML = status;
    }
    )
	</script>
</body>

</html>